{
  "hash": "588dd0e833fa65bb993453d158f08dca",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Remote Sensing Methods for Identifying Ephemeral Water Bodies Across Arizona\nauthor:\n  - name: Travis Zalesky\n    orcid: 0009-0006-0181-3099\n    corresponding: true\n    email: travisz@arizona.edu\n    roles:\n      - Investigation\n      - Project administration\n      - Software\n      - Visualization\n    affiliations:\n      - University of Arizona\nkeywords:\n  - ephemeral (transient) water\n  - flood\n  - LandSat\n  - MODIS\n  - playa\n  - remote sensing\n  - satellite data\n  - sheet flow\n  - synthetic aperture radar (SAR)\nabstract: |\n  A variety of remote sensing methods are investigated for their ability to detect ephemeral water bodies across the state of Arizona. The strengths and weaknesses of each are discussed.\nplain-language-summary: |\n  Results and methods for detecting transient water bodies using satellite data.\ndate: last-modified\nbibliography: references.bib\ncsl: apa.csl  # citation style guide\nnumber-sections: true\njupyter: python3\n---\n\n\n\n\n\n\n## Introduction\nAs part of the Arizona Tri-University Recharge (ATUR) project, multiple methods for identifying and quantifying ephemeral water bodies across the state of Arizona (AZ) have been investigated. For reasons that will be discussed, accurate identification of ephemeral, or temporary, water bodies is a challenge, and efforts to-date have shown limited success. Methods, results, and challenges are discussed, and potential paths forward shall be explored.\n\nEphemeral water bodies are common features in the arid American southwest. Typically very shallow, these water bodies range in size from a few cm rock pools to sheet flow associated with flash floods, and playas up to several km in diameter [@Clifford_Crawford; @Whitford_Duval_2020]. While playas and intermittent streams are well mapped across AZ, there is no consensus on the volume of water which flows through these systems. More to the point, there is no widely accepted estimate of the volume of water which either evaporates or recharges from these internally draining basins. \n\nIt is not clear what fraction of water which flows onto a playa is evaporated vs. recharged. On the one hand, the nature of playas results in the slow accumulation of surface salts and fine sediments (clays and silts), which are generally impervious and detrimental to infiltration and subsequent recharge [@Whitford_Duval_2020]. Additionally, playas may be an oasis for drought resistant flora, increasing local evapotranspiration, even after shallow surface soil layers have dried out [@Clifford_Crawford]. Alternately, these mineral rich surface crusts may be prone to expansion when wetted, and are frequently characterized by deep cracks which provide avenues for water infiltration below the impervious layers [@Whitford_Duval_2020]. While the majority of water flowing onto most playas will be lost to evaporation, there may be specific playas where water loss by infiltration may exceed evaporation [@Whitford_Duval_2020]. At least initially, we will assume that all water flowing onto playas shall be evaporated, subject to later reevaluation and refinement.\n\nThe primary target of this study is to estimate and quantify the volume of water flowing into small to medium sized playas, on the order of ~500 m to ~10 km in diameter, although identification of sheet flow may also be incidental. The general method outlined is to use remote sensing technology to identify standing water broadly across the study area, across a time series. By identifying standing water, and assuming a constant water depth, water volume can be estimated. Additionally, an approximation of \"continuously wetted\" days can provide an initial estimate of evaporation rates, and through comparison with alternate evapotranspiration estimates, may be useful for estimating infiltration rate (e.g. if water loss rate is 2 cm/day and the evapotranspiration rate is 1.5 cm/day then the implied infiltration rate would be 0.5 cm/day).\n\nThe study area used for method development is primarily Hualapai (pronounced \"wall-a-pie\") Playa (a.k.a. Red Lake), located in northwest AZ, approx. 60 km southeast of Lake Mead (@fig-PlayaRef). This ephemeral playa is roughly 8 km in diameter, and is one of the largest playas in AZ. Furthermore, local landowners surrounding Hualapai Playa have expressed sincere interest in our project, creating additional public-relations incentives related to this particular playa. Lastly, it's proximity to Lake Mead and Lake Mohave provide a convenient region for testing these methods against known areas of permanent surface water. Additional playas are investigated as needed.\n\n![Hualapai Playa locator map.](images/Hualapai_Playa_Reference.png){#fig-PlayaRef}\n\nOne of the most challenging aspects of developing these methods is the lack of quality ground-truth data. Without existing data regarding date and duration of standing water within these ephemeral features, it is extremely difficult to validate our methods. While reasonable assumptions can be made about method accuracy (or inaccuracy as the case may be), any method, either those presented herein, or future methods not yet considered, will have to be validated using a known and well characterized ephemeral water body, ideally within AZ, or elsewhere in a similar arid environment. \n\n## Methods & Results\n\n### Method 1: Otsu Thresholding with Synthetic Aperture Radar\nOtsu thresholding is an unsupervised machine vision technique which seeks an optimal threshold for segmenting an image into a binary classification based on a simple histogram classification [@otsu1975threshold]. The method was initially developed in the late '70s, and is widely applicable to a range of computer vision classification problems. It assumes a bi-modal histogram distribution and determines an optimal thresholding value through the integration of the histogram, rather than simply relying on local histogram properties \"such as valley[s]\" [@otsu1975threshold]. In recent years, Otsu thresholding has been combined with Synthetic Aperture Radar (SAR) satellite imagery to map surface water, such as flood monitoring in the Mekong Delta [@Tran_Menenti_Jia_2022]. The properties of surface water and SAR make an ideal pairing for use in Otsu thresholding. The smooth surface characteristics of surface water create low SAR back-scatter, appearing as very dark pixels (Figures [-@fig-scatter]-[-@fig-LakeMead_S1]). Compared to the surrounding land surface, water typically has a very high contrast in SAR imagery, which can be leveraged for Otsu thresholding. Additionally, the cloud penetrating characteristics of SAR offer unparalleled all-weather monitoring capabilities.\n\n![Synthetic Aperture Radar signal return strength (i.e. back-scatter) is a function the roughness of the ground surface. Credit: @Franz_Meyer_2019, Figure 2.8. For educational purposes only.](images/wavelength_vs_roughness.png){#fig-scatter}\n\n![High resolution Synthetic Aperture Radar (SAR) imagery of Lake Mead, obtained from the European Space Agency (ESA) Sentinel-1 satellite (1-1-2020). Surface water appears dark, and contrasts strongly with the surrounding land surface, resulting in a bimodal histogram distribution, ideal for use in Otsu thresholding.](images/LakeMead_S1.png){#fig-LakeMead_S1}\n\nThis method initially seemed like an ideal solution. High resolution SAR imagery is freely available from the European Space Agency (ESA) Sentinel-1 satellite, with a global coverage from late 2014 to present, and a 6-day revisit time. Google Earth Engine (GEE) code for Otsu thresholding was easily adapted from @GEE_A2.3, and preliminary results appeared to be promising. Initial analysis appeared to show surface water ponding on Huyalapai Playa in mid-Jan 2020. These preliminary results were circulated internally, and purported to be both evidence of surface water, and proof-of-concept for method validation. However, further research and wider application of this method revealed two critical flaws. \n\nFirstly, the method, as applied in GEE, was highly sensitive to the size and characteristics of any given playa. For larger playas, the method was generally suitable, but required a substantial amount of manual parameter optimization to function properly. For small to medium sized playas, the method was largely unstable, resulting in persistent errors. As a result this method is not particularly scalable, and at best could be used for a selection of the states largest playas, such as Huyalapai and Willcox Dry Lake (southeast AZ).\n\nMore critically, this method is sub-optimal for arid regions, as flat sandy surfaces also result in low SAR back-scatter, appearing similar or indistinguishable from surface water. The hard-pan surface of a dry playa is particularly apt to be misidentified by this method, resulting in a high likelihood of false positives. It is currently unclear if the preliminary results purporting to have identified surface water on Huyalapai Playa in Jan. 2020 are true or false positives, as there is no associated ground-truthing data against which to compare. Regardless of the truthiness of these results it is evident that this method can not be used reliably within the study area without widespread and comprehensive testing and validation of results. Given the scheduling and budgetary constraints of this project widespread survey data collection is not feasible, and while further development of this method may be warranted (generally), it is not appropriate for our purposes. Therefore alternate methods must be explored.\n\n### Method 2: Normalized Difference Water Index with Landsat Multispectral Imagery\n\nCollectively, the 9 Landsat satellites provide the longest continuous record of space-based earth observations, from 1973 to present. Therefore, it may seem like an obvious candidate for monitoring infrequent phenomena, such as surface water ponding on playas, which may only happen once every several years (depending on the playa). However, Landsat imagery has several disadvantages compared to SAR. Firstly, the 30 m resolution of Landsat imagery is nine times coarser than the 10 m resolution of Sentinel-1 SAR. Second, the revisit time for Landsat satellites is 16-days, more than double that of Sentinel-1. By combining data from multiple Landsat satellites this effective revisit time may be cut to 8-days, but this may not be possible throughout the full time series of interest. Additionally, the visible and infrared spectral bands used by Landsat sensors are not capable of penetrating clouds, and while cloud-masking can be achieved through post-processing, the presence of clouds has the potential to obfuscate the phenomena of interest. Combined, these three disadvantages compound, resulting in much sparser data availability for Landsat imagery in comparison to Sentinel-1.\n\nFurthermore, while indices for surface water monitoring utilizing Landsat spectral bands, such as the Normalized Difference Water Index (NDWI), are widely used, they are imprecise classifiers on their own. NDWI in particular, is suspectable to misclassifying shadows as water. NDWI is defined as the difference between the green and near-infrared (NIR) bands divided by the sum of the green and NIR bands (for Landsat 8/9, bands 3 and 5 respectively; @eq-NDWI).\n\n$$\nNDWI = \\frac{Green - NIR}{Green + NIR}\n$${#eq-NDWI}\n\nDespite these disadvantages, it may still be possible to characterize and quantify ephemeral water bodies using this dataset.\n\nFortunately, Landsat data is freely available, easily accessible through GEE, and Landsat Collection 2 datasets include post-processing data which is directly applicable to this method, including cloud and cloud shadow masks, as well as a pre-calculated water mask (which appears to be largely coincident with NDWI > 0). However, this water mask is over inclusive, and not suitable for use as is.\n\nA large number of features identified as water in the provided Landsat water mask layer appeared to correspond to the northward aspect of terrain features. Therefore, to refine the provided layer by reducing the false positives resulting from natural terrain shadows I created a hillshade (or hill shadow) layer in GEE from a high resolution (10 m) USGS digital elevation model (DEM). For each image in the Landsat collection, sun angle and azimuth were obtained from the image metadata and passed to the hillshadow function to create a custom terrain shadow mask. The provided Landsat water mask was compared against the custom terrain shadow mask, and any purported water which overlapped a terrain shadow was removed.\n\nUpon evaluation, this method worked fairly well, but still left lots of small crescent shaped remnants of the Landsat water mask resulting from the mis-matched resolution of the imagery and the DEM. Therefore the hillshade was dilated using a local minimum function with a 150 m (5 pixel) square neighborhood. This effectively removed most of the remaining stippling and partial terrain shadows, however it also partially clipped some known water features, for example along the southern shore of Lake Mead. Although the accuracy has not been formally tested, visual analysis appears to confirm that the removal of false positives (terrain shadows) substantially outweighs the loss of true positives (masked water bodies).\n\n::: {.callout-note}\nThis hillshadow dilation method was the first idea, and works reasonably well, with some losses of correctly identified water mask, particularly adjacent to steep terrain. \n\nAn alternate strategy to reduce stippling and partial terrain shadows would be to identify and remove small features using a connected pixel count, as in the [Random Forest Flood Map](https://travisz09.github.io/ATUR-RF-Flood-Map).\n:::\n\nThis method appears to be working reasonably well, as it is consistently identifying know bodies of water such as Lake Mead, even appearing to capture fluctuating water levels in the lake's headwaters, while limiting the number of false positives from terrain shadows (@fig-LakeMead_LS). However, it still requires on the ground validation with a known ephemeral water body. Additionally, there still remain some number of false positives associated with large building shadows (buildings are not included in DEMs), such as in Las Vegas, and a number of unmasked cloud shadows (@fig-clouds).\n\n![Time series analysis of 22 Landsat images of Lake Mead and Hualapai Playa in 2020 with potential water sources mapped in blue. The more frequently a pixel was identified as water, the more saturated the color.](images/LakeMead_LS.png){#fig-LakeMead_LS}\n\n::: {#fig-clouds layout-ncol=2}\n\n![](images/Clouds1.jpg)\n\n![](images/Clouds2.jpg)\n\nGoogle Earth Engine screen captures. A cloud moving over Hualapai Playa on 11/26/2020 cast a shadow which is only partially captured by the cloud mask (right; black), and is subsequently misclassified as water by the algorithm (right; blue).\n\n:::\n\nDespite its limitations compared to SAR data, this Landsat method has shown enormous potential. Further development of this method is warranted, and methodological improvements are likely. However, to fully validate this method **we desperately need to find Landsat images of a known ephemeral water body when flooded**. This need for a known test case to validate the method is made more challenging by the long revisit time of the Landsat satellites, as well as the need for clear (cloud free) conditions. **Any available historical records of known flood events on Hualapai Playa, or other large playas in the state would be enormously helpful!**\n\n## Further Recommendations\n\n## Conclusion\n\n## References {.unnumbered}\n\n::: {#refs}\n:::\n\n",
    "supporting": [
      "index_files\\figure-jats"
    ],
    "filters": []
  }
}